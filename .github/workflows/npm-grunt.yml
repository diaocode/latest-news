name: Build and Deploy to GitHub Pages

# è§¦å‘æ¡ä»¶ï¼šå½“æ¨é€åˆ° main åˆ†æ”¯æ—¶è¿è¡Œ
on:
  push:
    branches: [ main ]  # å¦‚æœä½ çš„ä¸»åˆ†æ”¯æ˜¯ masterï¼Œè¯·æ”¹ä¸º master

# å®šä¹‰ä¸€ä¸ªåä¸º build çš„ä½œä¸š
jobs:
  build:
    name: æ„å»ºä¸éƒ¨ç½²
    runs-on: ubuntu-latest

    # ä½¿ç”¨ matrix æ¥æŒ‡å®š Node.js ç‰ˆæœ¬
    strategy:
      matrix:
        node-version: ['20.x']  # ä½¿ç”¨å°å†™ 'x'ï¼Œå¹¶ç”¨å¼•å·åŒ…è£¹ä¸ºå­—ç¬¦ä¸²

    steps:
      # æ­¥éª¤ 1: æ£€å‡ºä»“åº“ä»£ç 
      - name: ğŸ›  æ£€å‡ºä»£ç 
        uses: actions/checkout@v4

      # æ­¥éª¤ 2: è®¾ç½® Node.js ç¯å¢ƒ
      - name: ğŸ“¦ è®¾ç½® Node.js ${{ matrix.node-version }}
        uses: actions/setup-node@v4
        with:
          node-version: ${{ matrix.node-version }}

      # æ­¥éª¤ 3: å®‰è£…é¡¹ç›®ä¾èµ–
      - name: ğŸ”§ å®‰è£…ä¾èµ–
        run: |
          npm install
          # å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ gruntï¼Œç¡®ä¿ grunt-cli å·²å®‰è£…
          npm install -g grunt-cli

      # æ­¥éª¤ 4: è¿è¡Œæ„å»ºå‘½ä»¤ï¼ˆå¦‚ grunt buildï¼‰
      - name: ğŸ— æ‰§è¡Œæ„å»º (grunt build)
        run: |
          grunt build  # è¯·ç¡®ä¿ package.json ä¸­æœ‰ build è„šæœ¬æˆ– grunt é…ç½®

      # æ­¥éª¤ 5: é…ç½® GitHub Pages
      - name: ğŸŒ é…ç½® GitHub Pages
        uses: actions/configure-pages@v5
        with:
          # å‡è®¾æ„å»ºè¾“å‡ºåœ¨ ./dist æˆ– ./public ç›®å½•
          # è¯·æ ¹æ®ä½ çš„å®é™…æ„å»ºè¾“å‡ºç›®å½•ä¿®æ”¹
          build-output: ./dist    # å¸¸è§è¾“å‡ºç›®å½•ï¼š./dist, ./public, ./build ç­‰
          # å‹ç¼©é€‰é¡¹ï¼ˆå¯é€‰ï¼‰
          # single-page-application: true

      # æ­¥éª¤ 6: éƒ¨ç½²åˆ° GitHub Pages
      - name: ğŸš€ éƒ¨ç½²åˆ° GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./dist     # æ„å»ºè¾“å‡ºçš„ç›®å½•
